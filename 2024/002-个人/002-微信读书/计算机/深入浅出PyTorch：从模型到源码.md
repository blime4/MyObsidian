---
doc_type: weread-highlights-reviews
bookId: "30638126"
author: 张校捷
cover: https://cdn.weread.qq.com/weread/cover/47/YueWen_30638126/t7_YueWen_30638126.jpg
reviewCount: 1
noteCount: 15
readingStatus: 读完
progress: 100%
totalReadDay: 13
readingTime: 3小时26分钟
readingDate: 2022-10-10
finishedDate: 2023-06-14
isbn: 9787121386411
lastReadDate: 2023-06-14

---
# 元数据
> [!abstract] 深入浅出PyTorch：从模型到源码
> - ![ 深入浅出PyTorch：从模型到源码|200](https://cdn.weread.qq.com/weread/cover/47/YueWen_30638126/t7_YueWen_30638126.jpg)
> - 书名： 深入浅出PyTorch：从模型到源码
> - 作者： 张校捷
> - 简介： 本书从机器学习和深度学习的基础概念入手，由浅到深地详细介绍了PyTorch深度学习框架的知识，主要包含深度学习的基础知识，如神经网络的优化算法、神经网络的模块等；同时也包含了深度学习的进阶知识，如使用PyTorch构建复杂的深度学习模型，以及前沿的深度学习模型的介绍等。另外，为了加深读者对PyTorch深度学习框架的理解和掌握，本书还介绍了PyTorch的源代码结构，包括该框架的Python语言前端和C++语言后端的源代码结构。
> - 出版时间 2020-03-01 00:00:00
> - ISBN： 9787121386411
> - 分类： 计算机-编程设计
> - 出版社： 电子工业出版社
> - PC地址：https://weread.qq.com/web/reader/b3132b9071d3802eb3134c5

# 高亮划线

## 第9章 PyTorch源代码解析

> 📌 PyTorch的C++接口主要是通过ATen张量计算库（A Tensor Library）来实现的，主要在PyTorch源代码的aten目录下面。 
> ⏱ 2022-11-05 19:56:21 ^30638126-73-638-711

> 📌 进入src目录会发现它下面主要有ATen（ATen的核心源文件）、TH（Torch张量计算库）、THC（Torch CUDA张量计算库）、THCUNN（Torch CUDA神经网络库）和THNN（Torch神经网络库）。 
> ⏱ 2022-11-05 19:58:22 ^30638126-73-1177-1287

> 📌 其中，以TH开头的文件夹都来源于原始Torch的C语言后端，TH和THC分别是CPU和GPU上的张量计算库，而THNN和THCUNN则分别负责CPU和GPU上的神经网络搭建。 
> ⏱ 2022-11-05 19:59:12 ^30638126-73-1287-1374

> 📌 关于张量计算的最核心的源代码应该是Tensor.h，这个头文件定义了张量中数据的存储格式，以及张量支持的内部方法。 
> ⏱ 2022-11-05 20:01:08 ^30638126-73-1701-1758

> 📌 有了张量类的定义和实现还不够，另一个比较重要的是定义张量的一些计算函数。这些函数主要在native目录下进行定义，函数对应的头文件主要是Functions.h和NaticeFunction.h两个文件。 
> ⏱ 2022-11-05 20:08:26 ^30638126-73-2343-2444

> 📌 经过进一步的代码跳转，可以发现at：：convolution函数调用的是at：：_convolution函数，这个函数会对输入参数进行判断，根据判断结果选择具体跳转到哪一个卷积的实现。 
> ⏱ 2022-11-06 09:39:01 ^30638126-73-3688-3780

### 9.2 C++的Python接口

> 📌 pybind11还能直接使用一些数值计算库如NumPy和Eigen的矩阵实现，这样就更加方便了pybind11用于一些数值计算相关代码的开发。 
> ⏱ 2022-11-05 19:33:40 ^30638126-74-1235-1306

### 9.3 csrc模块简介

> 📌 从torch/csrc目录下的源代码可以看出，对于ATen相关的函数映射，目前PyTorch的源代码主要采用的是方法二来调用C++接口，对于其他类型的函数映射，PyTorch源代码采用的是方法一来调用C++接口。 
> ⏱ 2022-11-06 17:33:57 ^30638126-75-1453-1559

> 📌 编译速度快，而且严格兼容C语言的ABI 
> ⏱ 2022-11-06 17:35:39 ^30638126-75-1741-1760

> 📌 在torch/csrc库中，大部分张量函数的结构在torch/csrc/autograd目录中，这个目录不但负责自动求导的功能（将会在下一节中提到），还负责将ATen函数库可导的C/C++函数进行包装，导出为Python可以调用的函数。 
> ⏱ 2022-11-07 09:41:39 ^30638126-75-2439-2557

> 📌 设置这个选项会使PyTorch预先使用不同的算法运行几个迭代步，然后选择其中最快的算法来进行真正的计算。 
> ⏱ 2023-06-07 18:38:33 ^30638126-75-3674-3726

### 9.4 autograd和自动求导机制

> 📌 torch/csrc/autograd目录，这个目录中包含PyTorch的自动求导机制和所有可导的激活函数。 
> ⏱ 2022-11-07 22:36:03 ^30638126-76-578-632

> 📌 并且增加了一系列新的信息来进行自动求导的计算 
> ⏱ 2022-11-07 22:45:51 ^30638126-76-822-844

### 9.5 C10张量计算库简介

> 📌 一般情况下，因为PyTorch是基于动态图的一个框架，而Caffe2是基于静态图的一个框架，可以认为PyTorch的优点在于其灵活性，而Caffe2的优点在于其速度快、容易部署。 
> ⏱ 2023-06-14 01:48:38 ^30638126-77-570-659

> 📌 目前的趋势是，ATen库的一部分功能被迁移到C10库中（当然还有很多功能没有迁移），预计PyTorch将会完全以C10作为后端，这样PyTorch和Caffe2可以使用一套底层代码，方便模型的训练和部署。 
> ⏱ 2023-06-14 01:49:08 ^30638126-77-752-854

# 读书笔记

# 本书评论

## 书评 No.1 
反而觉得前面没啥意思，后面几章反倒对 pytorch 源码学习有作用，前面调用 api罢了。 ^10284435-7IWWwJhAY
⏱ 2023-06-14 02:10:14
