
《简单易懂diffusion模型讲解 - Diffusion模型简明综述》
介绍
（翻页）
这是几个主流的生成模型的结构，上一期视频有介绍GAN还有VAE，这里主要介绍一下diffusion。
Diffusion模型定义了一个马尔可夫链，用于在扩散步骤中缓慢地向数据添加随机噪声，然后通过学习逆转扩散过程从噪声中构建所需的数据样本。引入的噪声导致了信息的衰减，再通过去噪尝试还原原始数据，这样的多次迭代，能够使模型在给定噪声输入的情况下学习生成新图像。
Diffusion模型的灵感来自于非平衡热力学。每一次前向过程的采样，本质是添加噪声。前向过程，模型缓慢地将随机噪声添加到数据中，然后学习逆向扩散过程以从噪声中构造所需的数据样本。
（翻页）
对于diffusion模型的基础算法，我们需要关注它的前向过程和逆向过程，还有它的训练目标。
我们先来看前向过程，
每一步，我们都会添加高斯噪声，对于xt-1到xt的过程，
我们对xt-1添加方差为贝塔t的正态分布的高斯噪声，从而得到xt。
这个蓝圈xT下面标的是它的分布，
公式这边，这里的贝塔t是方差，它是属于零到一的。i是一个单位矩阵，这意味着每个维度的贝塔t都是相同的。而这个高斯分布的均值是根号1-贝塔t 再乘上xt-1。
（翻页）
实际应用中，这里一般不会这样采样xt，会用到一个重参数化的技巧。因为你想想，我们的timestep T一般是要比较大的，假如我们timestep是几百上千的，那也就是说我们要算这个前向的过程几百上千次，很显然是很耗费算力的。所以会用到重参数化。
重参数化本质上是把从任意一个高斯分布中采样xt的过程，转换成从标准高斯分布中采样xt的过程。
假设我们想要进行采样的高斯分布，均值是μ，方差是σ^2
我们会先从一个均值为0，方差为1的标准高斯分布中采样，得到ε。
那么μ + σ·ε便是我们想要的结果。
根据这个基本原理，我们就可以用重参数化的技巧推导出xt。
这里的βt，是我们训练模型之前就设置好的hyperparameter，也就是超参数，因此我们可以预计算所有timestep的αt和αt拔。也就不用重复xt之前所有的前向步骤来采样xt了，我们可以在任意的timestep一步到位采样xt。
（翻页）
Diffusion模型的前向过程，定义了一种简单的把数据分布映射到标准高斯的过程，使得生成器可以直接拟合这个过程每一小步的逆过程。
因为任何分布沿着马尔科夫链一直采样下去最终都可以得到某种平稳分布。
所以，这个前向过程，构造了一个平稳分布是标准高斯分布的马尔科夫链。为了最终的隐变量为高斯分布，这里的转移概率可以如图上式子这样构造。
前面我们提到，变分后验的选择是生成模型的一个痛点，后验概率难做，这意味着逆向过程会很难做。
而diffusion模型这样的构造有一个重要特性——前向过程的每一小步的逆过程都可以近似为高斯分布，所以它的逆向过程也很好做。
前向过程对应的后验概率可以根据贝叶斯公式推导。
（翻页）
这里是它的一个详细推导案例，感兴趣的可以暂停看一眼。
tips：这里推导的后验分布是对应前向过程的后验分布
（翻回）
实际上，我们在做生成的时候，刚才那个公式的x0是未知的，我们是不知道这个后验概率的，因此，我们这里就需要用模型去拟合它。这里pθ就是我们参数化的模型。我们未知的后验概率是高斯分布的，因此我们模型也是高斯分布的，只要超参数βt足够小，我们只需要对模型的平均值和方差进行参数化即可。


