muduo 日志库采用的是双缓冲（[[double buffering]]）技术，基本思路是准备两块 buffer：A 和 B，前端负责往 buffer A 填数据（日志消息），后端负责将 buffer B 的数据写入文件。当 buffer A 写满之后，交换 A 和 B，让后端将 buffer A 的数据写入文件，而前端则往 buffer B 填入新的日志消息，如此往复。用两个 buffer 的好处是在新建日志消息的时候不必等待磁盘文件操作，也避免每条新日志消息都触发（唤醒）后端日志线程。换言之，前端不是将一条条日志消息分别传送给后端，而是将多条日志消息拼成一个大的 buffer 传送给后端，相当于批处理，减少了线程唤醒的频度，降低开销。另外，为了及时将日志消息写入文件，即便 buffer A 未满，日志库也会每 3 秒执行一次上述交换写入操作。

[[AsyncLogging]]